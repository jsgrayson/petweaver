<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pet Hunting - PetWeaver</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <div class="container">
        <header>
            <div class="logo">
                <h1>ğŸ¯ Pet Hunting Guide</h1>
            </div>
            <nav>
                <a href="/">Home</a>
                <a href="/dashboard">Dashboard</a>
                <a href="/strategies">Strategies</a>
                <a href="/wizard">Wizard</a>
                <a href="/hunting" class="active">Hunting</a>
                <a href="/leveling">Leveling</a>
            </nav>
        </header>

        <main>
            <!-- Stats -->
            <div class="card">
                <h2>Missing Pets Priority List</h2>
                <p style="color: var(--text-muted); margin-bottom: 1.5rem;">
                    Pets you need to unlock more strategies, sorted by priority
                </p>
            </div>

            <!-- Missing Pets List -->
            <div id="missing-pets">
                <div class="loading">Loading missing pets...</div>
            </div>
        </main>
    </div>

    <script>
        function loadMissingPets() {
            fetch('/api/hunting/missing')
                .then(res => res.json())
                .then(data => {
                    const container = document.getElementById('missing-pets');

                    if (data.length === 0) {
                        container.innerHTML = `
                            <div class="card">
                                <div style="text-align: center; padding: 2rem; color: var(--success);">
                                    <h2>ğŸ‰ You have all required pets!</h2>
                                    <p>No missing pets for your ready strategies.</p>
                                </div>
                            </div>
                        `;
                        return;
                    }

                    container.innerHTML = data.map((pet, index) => `
                        <div class="card" style="margin-bottom: 1rem;">
                            <div style="display: flex; justify-content: space-between; align-items: start; gap: 1rem;">
                                <div style="flex: 1;">
                                    <h3 style="margin: 0 0 0.5rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: var(--primary);">#${index + 1}</span>
                                        ${pet.name}
                                        <span class="badge" style="background: rgba(239, 68, 68, 0.2); color: #ef4444;">
                                            Needed for ${pet.needed_for.length} encounter(s)
                                        </span>
                                    </h3>
                                    
                                    <!-- Location Info -->
                                    <div style="margin: 0.75rem 0; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-left: 3px solid var(--primary); border-radius: 4px;">
                                        <div style="display: grid; grid-template-columns: auto 1fr; gap: 0.5rem; font-size: 0.9rem;">
                                            <strong style="color: var(--text-muted);">ğŸ“ Zone:</strong>
                                            <span>${pet.zone || 'Unknown'}</span>
                                            
                                            <strong style="color: var(--text-muted);">ğŸ Source:</strong>
                                            <span>${pet.source || 'Unknown'}</span>
                                            
                                            <strong style="color: var(--text-muted);">ğŸ—ºï¸ Coords:</strong>
                                            <span>${pet.coords || 'N/A'}</span>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-top: 0.75rem;">
                                        <strong style="color: var(--text-muted); font-size: 0.9rem;">Used in:</strong>
                                        <div style="margin-top: 0.5rem; display: flex; flex-wrap: wrap; gap: 0.5rem;">
                                            ${pet.needed_for.slice(0, 5).map(enc =>
                        `<span class="pet-badge">${enc}</span>`
                    ).join('')}
                                            ${pet.needed_for.length > 5 ?
                            `<span style="color: var(--text-muted); font-size: 0.85rem;">+${pet.needed_for.length - 5} more</span>`
                            : ''}
                                        </div>
                                    </div>
                                </div>
                                <a href="${pet.warcraftpets_url || 'https://www.google.com/search?q=' + encodeURIComponent(pet.name + ' warcraftpets')}" 
                                   target="_blank" 
                                   class="btn-primary" 
                                   style="width: auto; padding: 0.5rem 1rem; text-decoration: none; white-space: nowrap;">
                                    More Info
                                </a>
                            </div>
                        </div>
                    `).join('');
                });
        }

        // Load on page load
        loadMissingPets();
    </script>
</body>

</html>