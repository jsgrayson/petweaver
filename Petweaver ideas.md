Project Design Document: PetBattle Tactician ("The Silent Assassin")  
1\. Executive Summary  
Concept: A hybrid "Addon \+ Desktop Engine" system designed to completely solve World of Warcraft Pet Battles. Goal: To allow the user to navigate the world, manage teams, and win battles with 100% efficiency using a single physical keypress (Spacebar) and zero on-screen HUD. Philosophy: "The Lazy God." The user provides the hardware event (keypress); the system provides the strategy, navigation, and execution.

2\. System Architecture  
To bypass WoW's Lua limitations and ensure "One-Button" efficiency without breaking TOS (botting), the system is split into three layers:

Layer 1: The Executioner (WoW Addon)

Role: The dumb client. It displays nothing and thinks little. It only executes orders pushed to it.

Tech: Lua, SecureStateDriver, TomTom API, Rematch API.

Function: Handles the "Master Key" logic, rendering the navigation arrow, and executing battle commands.

Layer 2: The Brain (Desktop Agent)

Role: The heavy lifter. Runs in the background on the PC.

Tech: Rust/C++ (for simulation speed), File Watcher (to sync with Lua).

Function: Runs Genetic Algorithms to build teams, Minimax/Monte Carlo to solve battles, and manages the "Playlist" of targets.

Layer 3: The War Room (Web Portal)

Role: The command center.

Tech: Localhost Web Server (React/Svelte).

Function: Displays the collection, TSM market data, and allows drag-and-drop route planning.

3\. The Addon ("The Executioner")  
Designed to be invisible. Operated by a single key.

A. The "Master Key" (Context-Aware Input)

One physical key (Spacebar) dynamically changes function based on the game state using SecureStateDriver.

State: Idle: Targets the Next Trainer in the Playlist \+ Sets TomTom Arrow.

State: Moving: Triggers InteractWithTarget (CTM) to auto-run to the NPC.

State: Gossip: Auto-selects "Let's Battle" (skips dialog).

State: Combat: Fires the "Auto-Battle" script button (executes the Solver's moves).

State: Post-Combat: Casts Revive Battle Pets or uses a Bandage.

B. Navigation & "The Circuit"

Playlist Sync: The Addon receives a list of coordinates from the Desktop Engine (e.g., "Pandaria Daily Circuit").

Auto-Routing: Upon winning a battle, it immediately sets the TomTom arrow to the next target.

Click-Assist: Renders an invisible screen-wide button when out of combat; clicking anywhere triggers movement to the target.

C. The Kill Switch

Pre-Battle Simulation: If the Desktop Engine detects a \<100% win chance (due to RNG like Crits), the Addon executes ForfeitGame() immediately on the first turn to reset and retry without wasting time.

D. "The Black Box" (Feedback)

Instead of a HUD, a single 1x1 pixel in the corner of the screen communicates status:

Black: Idle / Safe to press Spacebar.

Red: STOP/ERROR (Bag full, Out of Bandages, Stuck).

4\. The Desktop Engine ("The Brain")  
The logic powerhouse running outside the game.

A. Genetic Team Builder (The Solver)

To find the perfect team for a trainer without checking 4 billion combinations:

Pool: Picks 100 random teams from your collection.

Simulate: Runs battles against the specific Trainer's AI.

Evolve: Breeds the winners and mutates slots (e.g., "Swap Rabbit for Frog").

Result: Finds a 100% Win Rate team in \<30 seconds.

B. Strategist Engine (Minimax \+ Monte Carlo)

Once a team is picked, it solves the battle logic:

Game Tree: Simulates 15 turns into the future.

Minimax: Assumes the enemy plays perfectly; finds the path that guarantees a win.

Monte Carlo: Replays the winning path 1,000 times with random RNG to ensure stability.

5\. The "Tactician Syntax" (TTS)  
A custom, human-readable strategy language generated by the Engine and executed by the Addon.

Format: \[TRIGGER\] :: \[ACTION\]

The Commands

BLOCK: Only fires if the enemy is about to deal massive damage.

MAINTAIN: Only fires if a specific buff/debuff/weather is missing.

EXECUTE: Only fires if the enemy is in kill range.

SPAM: The default filler move.

Example Strategy (Generated Code)

Scenario: Anubisath Idol vs. Dragonkin

Plaintext  
BLOCK     :: BIG HIT (Deep Breath) \-\> Use Deflection  
MAINTAIN  :: Sandstorm             \-\> Use Sandstorm  
EXECUTE   :: HP \< 250              \-\> Use Crush  
SPAM      :: Filler                \-\> Use Crush  
The Desktop App compiles this simple list into complex Lua logic (if enemy.ability(Deep Breath).usable...) before sending it to the game.

6\. Data Pipeline  
How the system acquires data automatically.

Static Species Data: Blizzard Game Data API. (Stats, Abilities, Icons).

Trainer Teams/Locations: Data Mining. (Parsed from existing addon databases like PetTracker).

Proven Strategies: Xu-Fuâ€™s Pet Guides. (Mass-import of community scripts).

Market Pricing: TradeSkillMaster (TSM) API. (Real-time pet values).

7\. Workflow Summary  
Setup (Web Portal): You drag "Pandaria Circuit" into the queue.

Sync: Desktop Engine pushes the playlist to the Addon.

Execution (In-Game):

Tap Spacebar \-\> Target Nishi.

Tap Spacebar \-\> Run to Nishi.

Tap Spacebar \-\> Start Fight.

Tap Spacebar (x15) \-\> Win Fight (Script executes).

Tap Spacebar \-\> Heal & Target next trainer.

User Role: You watch Netflix on Monitor 2 and rhythmically tap one key. The system handles the rest.  
